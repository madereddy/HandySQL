SELECT
 S.NAME + '.' + T.NAME AS [TABLE NAME],
 PART.ROWS AS [TOTAL ROWS IN TABLE - MODIFIED],
 CAST((SUM( DISTINCT AU.TOTAL_PAGES) * 8 ) / 1024.000 / 1024.000 AS NUMERIC(18, 3))
 AS [TABLE'S TOTAL SPACE IN GB]
FROM
 SYS.TABLES T INNER JOIN SYS.SCHEMAS S ON T.SCHEMA_ID = S.SCHEMA_ID
 INNER JOIN SYS.INDEXES IDX ON T.OBJECT_ID = IDX.OBJECT_ID
 INNER JOIN SYS.PARTITIONS PART ON IDX.OBJECT_ID = PART.OBJECT_ID
                    AND IDX.INDEX_ID = PART.INDEX_ID
 INNER JOIN SYS.ALLOCATION_UNITS AU ON PART.PARTITION_ID = AU.CONTAINER_ID
 INNER JOIN SYS.FILEGROUPS FGRP ON IDX.DATA_SPACE_ID = FGRP.DATA_SPACE_ID
 INNER JOIN SYS.DATABASE_FILES DF ON DF.DATA_SPACE_ID = FGRP.DATA_SPACE_ID
WHERE T.IS_MS_SHIPPED = 0 AND IDX.OBJECT_ID > 255
GROUP BY T.NAME, S.NAME, PART.ROWS
ORDER BY [TABLE'S TOTAL SPACE IN GB] DESC
